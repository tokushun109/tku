{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":semanticCommits"
  ],
  "timezone": "Asia/Tokyo",
  "schedule": [
    "after 10pm and before 11pm on Thursday"
  ],
  "prHourlyLimit": 4,
  "prConcurrentLimit": 10,
  "minimumReleaseAge": "3 days",
  "enabledManagers": [
    "npm",
    "gomod",
    "dockerfile",
    "terraform",
    "github-actions",
    "asdf"
  ],
  "packageRules": [
    {
      "description": "majorは手動レビュー",
      "matchUpdateTypes": [
        "major"
      ],
      "labels": [
        "deps:major"
      ],
      "automerge": false,
      "prPriority": -1
    },
    {
      "description": "minor/patchは自動マージ（テスト成功が条件）",
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "automerge": true
    },
    {
      "description": "GitHub Actions は1PRに集約",
      "matchManagers": [
        "github-actions"
      ],
      "groupName": "GitHub Actions"
    },
    {
      "description": "Dockerfile ベースイメージ更新",
      "matchManagers": [
        "dockerfile"
      ],
      "groupName": "Docker base images"
    },
    {
      "description": "frontend: コア依存関係",
      "matchManagers": [
        "npm"
      ],
      "matchFileNames": [
        "frontend/**"
      ],
      "groupName": "frontend: core deps",
      "matchPackageNames": [
        "/^react/",
        "/^next/",
        "/^@next//",
        "/^typescript/"
      ]
    },
    {
      "description": "frontend: その他の依存関係",
      "matchManagers": [
        "npm"
      ],
      "matchFileNames": [
        "frontend/**"
      ],
      "groupName": "frontend: other deps"
    },
    {
      "description": "backend: コア依存関係",
      "matchManagers": [
        "gomod"
      ],
      "matchFileNames": [
        "backend/**"
      ],
      "groupName": "backend: core deps",
      "matchPackageNames": [
        "github.com/gorilla/mux",
        "gorm.io/gorm",
        "gorm.io/driver/mysql"
      ],
      "postUpdateOptions": [
        "gomodTidy"
      ]
    },
    {
      "description": "backend: その他の依存関係",
      "matchManagers": [
        "gomod"
      ],
      "matchFileNames": [
        "backend/**"
      ],
      "groupName": "backend: other deps",
      "postUpdateOptions": [
        "gomodTidy"
      ]
    },
    {
      "description": "infra: CDK for Terraform コア",
      "matchManagers": [
        "npm"
      ],
      "matchFileNames": [
        "infra/**"
      ],
      "groupName": "infra: CDKTF core",
      "matchPackageNames": [
        "/^cdktf/",
        "/^@cdktf//",
        "/^constructs/"
      ]
    },
    {
      "description": "infra: 開発ツール・型定義",
      "matchManagers": [
        "npm"
      ],
      "matchFileNames": [
        "infra/**"
      ],
      "groupName": "infra: dev tools + types",
      "matchPackageNames": [
        "/^@types//",
        "/^typescript/",
        "/^jest/",
        "/^ts-jest/",
        "/^ts-node/"
      ]
    },
    {
      "description": "Terraform プロバイダ/モジュール",
      "matchManagers": [
        "terraform"
      ],
      "groupName": "Terraform deps"
    },
    {
      "description": "asdf 言語バージョン管理",
      "matchManagers": [
        "asdf"
      ],
      "groupName": "asdf language versions",
      "matchFileNames": [
        ".tool-versions"
      ]
    },
    {
      "description": "Node.js LTS版のみ対象",
      "matchDatasources": [
        "node-version"
      ],
      "matchPackageNames": [
        "nodejs"
      ],
      "allowedVersions": "/^(18|20|22)\\./",
      "rangeStrategy": "bump"
    },
    {
      "description": "Go LTS版のみ対象",
      "matchDatasources": [
        "golang-version"
      ],
      "matchPackageNames": [
        "golang"
      ],
      "rangeStrategy": "bump"
    }
  ]
}
